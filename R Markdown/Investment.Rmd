---
title: "Investment Report"
author: "Adam"
date: "`r format(Sys.time(), '%d %B, %y')`"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(fig.align = 'center', out.width='80%', echo = TRUE)
```

```{r data, include = FALSE}
library(readr)
library(tidyverse)

investment_annual_summary <- read_csv('investment_annual_summary.csv')
investment_services_projects <- read_csv('investment_services_projects.csv')
```

## Datasets

### Investment Annual Summary

The `investment_annual_summary` dataset provides a summary of the dollars in millions provided to each region for each fiscal year, from 2012 to 2018.

```{r investment-annual-summary}
ggplot(investment_annual_summary, aes(fiscal_year, dollars_in_millions, color=region)) +
  geom_line() +
  labs(
    title = "Investment Annual Summary",
    x = "Fiscal Year",
    y = "Dollars in Millions") +
  theme(legend.key.size = unit(0.5, 'cm'),legend.position = 'bottom')
```

### Investment Projects in Brazil

The `investment_services_projects` dataset provides information about each investment project from 2012 to 2018. Information listed includes the project name, company name, sector, project status, and investment amounts.

```{r brazil-investment-projects}
brazil_investment_projects <- investment_services_projects %>%
  filter(country == 'Brazil')

ggplot(brazil_investment_projects, aes(date_disclosed, total_investment, color=status)) +
  geom_point() +
  labs(
    title = "Investment Services Projects",
    x = "Date Disclosed",
    y = "Total IFC Investment in Dollars in Millions") +
  theme(legend.key.size = unit(0.5, 'cm'),legend.position = 'bottom')
```

### Investment Projects in Brazil in 2018

```{r brazil-investment-projects-2018}
brazil_investment_projects_2018 <- investment_services_projects %>%
  filter(country == "Brazil",
         date_disclosed >= "2017-07-01",
         date_disclosed <= "2018-06-30") 

brazil_investment_projects_2018_total <- brazil_investment_projects_2018 %>%
  summarize(sum_total_investment = sum(total_investment, na.rm = TRUE)) 
```

The total investment amount for all projects in Brazil in the 2018 fiscal year was `r brazil_investment_projects_2018_total` million dollars.
